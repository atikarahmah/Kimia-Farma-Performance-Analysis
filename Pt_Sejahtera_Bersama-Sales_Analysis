CREATE TABLE Customers (
    CustomerID SERIAL PRIMARY KEY,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    CustomerEmail VARCHAR(100),
    CustomerPhone VARCHAR(15),
    CustomerAddress VARCHAR(100),
    CustomerCity VARCHAR(50),
    CustomerState VARCHAR(50),
    CustomerZip VARCHAR(10)
);

CREATE TABLE Orders (
    OrderID SERIAL PRIMARY KEY,
    Date DATE NOT NULL,
    CustomerID INT NOT NULL,
    ProdNumber VARCHAR(50) NOT NULL,
    Quantity INT NOT NULL,
    FOREIGN KEY (CustomerID) REFERENCES Customers(CustomerID)
);

CREATE TABLE ProductCategory (
    CategoryID SERIAL PRIMARY KEY,
    CategoryName VARCHAR(100) NOT NULL,
    CategoryAbbreviation VARCHAR(10) NOT NULL
);


CREATE TABLE Products (
    ProdNumber VARCHAR(50) PRIMARY KEY,
    ProdName VARCHAR(255) NOT NULL,
    Category INT NOT NULL,
    Price DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (Category) REFERENCES ProductCategory(CategoryID)
);

CREATE VIEW MasterData AS
SELECT
    c.CustomerEmail AS cust_email,
    c.CustomerCity AS cust_city,
    o.Date AS order_date,
    o.Quantity AS order_qty,
    p.ProdName AS product_name,
    p.Price AS product_price,
    pc.CategoryName AS category_name,
    (o.Quantity * p.Price) AS total_sales
FROM
    Orders o
JOIN Customers c ON o.CustomerID = c.CustomerID
JOIN Products p ON o.prodnumber = p.prodnumber 
JOIN ProductCategory pc ON p.Category = pc.CategoryID
ORDER BY o.Date ASC;


